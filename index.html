<!DOCTYPE html>
<html>
<head>
    <title>Associate Schedule</title>
    <style>
        /* Add your CSS here */
    </style>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load('current', {'packages':['timeline']});
        google.charts.setOnLoadCallback(drawChart);

        var dataTable;
        var shifts = [];
        var associates = [];

        function drawChart() {
            dataTable = new google.visualization.DataTable();
            dataTable.addColumn({ type: 'string', id: 'Associate' });
            dataTable.addColumn({ type: 'date', id: 'Start' });
            dataTable.addColumn({ type: 'date', id: 'End' });

            shifts.forEach(shift => {
                var row = [shift.associate, shift.start, shift.end];

                // Add lunch break
                if (shift.lunchStart && shift.lunchEnd) {
                    var lunchRow = [shift.associate, shift.lunchStart, shift.lunchEnd];
                    dataTable.addRow(lunchRow);
                }

                // Add breaks
                shift.breaks.forEach(breakTime => {
                    var breakRow = [shift.associate, breakTime.start, breakTime.end];
                    dataTable.addRow(breakRow);
                });
            });

            var container = document.getElementById('chart');
            var chart = new google.visualization.Timeline(container);
            chart.draw(dataTable);
        }

        function addAssociate() {
            var position = document.getElementById('position').value;
            var associateName = document.getElementById('associate-name').value;
            if (position === "" || associateName === "") {
                alert("Please enter both the position and associate name.");
                return;
            }

            var associate = position + " - " + associateName;

            // Add associate to the associates array
            associates.push(associate);

            // Update the associates dropdown menu
            updateAssociatesDropdown();
        }

        function updateAssociatesDropdown() {
            var associateSelect = document.getElementById('associate');
            associateSelect.innerHTML = '';

            // Add all associates to the dropdown menu
            for (var i = 0; i < associates.length; i++) {
                var option = document.createElement('option');
                option.text = associates[i];
                associateSelect.add(option);
            }
        }

        function downloadAssociatesData() {
            // Convert associates array to JSON
            var dataStr = JSON.stringify(associates);
            var dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);

            // Create a download link and click it
            var exportFileDefaultName = 'associates_data.json';
            var linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        }

        function uploadAssociatesData(event) {
            // Read the file using FileReader
            var file = event.target.files[0];
            var reader = new FileReader();
            reader.onload = function(event) {
                // Parse the JSON data
                var data = JSON.parse(event.target.result);

                // Update the associates array and dropdown menu
                associates = data;
                updateAssociatesDropdown();
            };
            reader.readAsText(file);
        }
    </script>
</head>
<body>
    <h1>Associate Schedule</h1>
    <div>
        <label for="position">Position:</label>
        <input type="text" id="position">
    </div>
    <div>
        <label for="associate-name">Associate Name:</label>
        <input type="text" id="associate-name">
    </div>
    <button onclick="addAssociate()">Add Associate</button>
    <div>
        <label for="associate">Select Associate:</label>
        <select id="associate">
            <!-- Associates will be dynamically populated here -->
        </select>
    </div>
    <div>
        <button onclick="downloadAssociatesData()">Download Data</button>
        <input type="file" id="upload" onchange="uploadAssociatesData(event)">
    </div>
    <div id="chart"></div>
</body>
</html>
